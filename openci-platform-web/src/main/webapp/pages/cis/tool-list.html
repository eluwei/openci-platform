<div id="toolGrid"></div>
<script>
	$(function() {
		var columns = [
			{
				title : '工具名',
				name : 'name',
				width : 150
			},
			{
				title : '工具类型',
				name : 'toolType',
				width : 150
			},
			{
				title : '工具地址',
				name : 'serviceUrl',
				width : 250
			},
			{
				title : '用户名',
				name : 'username',
				width : 120
			},
			{
				title : '密码',
				name : 'password',
				width : '120px'
			},
			{
				title : '是否可用',
				name : 'usable',
				width : 100,
				render: function(item, name, index){
					return item[name] ? '<span id="usable'+index+'" class="glyphicon glyphicon-ok" style="color:#5CB85C;margin-left:15px;"></span>':'<span class="glyphicon glyphicon-remove" style="color:#D9534F;margin-left:15px;"></span>'
				}
			},
			{
				title : '操作',
				name : 'usable',
				width : 'auto',
				render: function(item, name, index){
					return '<a><span class="glyphicon glyphicon-transfer"></span>&nbsp;测试连接</a>';
				}
			}
		];
		var buttons = [
			{
				content : '<button class="btn btn-primary" type="button"><span class="glyphicon glyphicon-plus"><span>添加</button>',
				action : 'add'
			}, 
			{
				content : '<button class="btn btn-success" type="button"><span class="glyphicon glyphicon-edit"><span>修改</button>',
				action : 'modify'
			}, 
			{
				content : '<button class="btn btn-danger" type="button"><span class="glyphicon glyphicon-remove"><span>删除</button>',
				action : 'delete'
			}
		];
		$('#toolGrid').grid({
			identity : 'id',
			columns : columns,
			buttons : buttons,
			url : 'toolconfiguration/pagingquery'
		}).on({
			'add': function(){
				toolManager.add($(this));
			},
			'modify': function(e, data){
				var indexs = data.data;
                var $this = $(this);
                if(indexs.length == 0){
                     $this.message({
                         type: 'warning',
                          content: '请选择一条记录进行修改'
                 	 });
                     return;
                 }
                 if(indexs.length > 1){
                     $this.message({
                         type: 'warning',
                           content: '只能选择一条记录进行修改'
                     });
                     return;
                 }
                toolManager.update($this, data.item[0]);
			},
			'delete': function(e, data){
				 var indexs = data.data;
                 var $this = $(this)
                 if(indexs.length == 0){
                      $this.message({
                           type: 'warning',
                           content: '请选择要操作的记录'
                   	  });
                       return;
                 }
                 $this.confirm({
                         content: '确定要删除所选记录吗?',
                         callBack: function(){ toolManager.del($this, data.item);}
                 });
			}
		});
	}); 
</script>
